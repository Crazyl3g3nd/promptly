// Simple Set Clipboard System
// Author: Joseph Huckaby
var ZeroClipboard_TableTools={version:"1.0.4-TableTools2",clients:{},moviePath:"",nextId:1,$:function(a){return"string"==typeof a&&(a=document.getElementById(a)),a.addClass||(a.hide=function(){this.style.display="none"},a.show=function(){this.style.display=""},a.addClass=function(a){this.removeClass(a),this.className+=" "+a},a.removeClass=function(a){this.className=this.className.replace(RegExp("\\s*"+a+"\\s*")," ").replace(/^\s+/,"").replace(/\s+$/,"")},a.hasClass=function(a){return!!this.className.match(RegExp("\\s*"+a+"\\s*"))}),a},setMoviePath:function(a){this.moviePath=a},dispatch:function(a,b,c){(a=this.clients[a])&&a.receiveEvent(b,c)},register:function(a,b){this.clients[a]=b},getDOMObjectPosition:function(a){var b={left:0,top:0,width:a.width?a.width:a.offsetWidth,height:a.height?a.height:a.offsetHeight};""!=a.style.width&&(b.width=a.style.width.replace("px","")),""!=a.style.height&&(b.height=a.style.height.replace("px",""));for(;a;)b.left+=a.offsetLeft,b.top+=a.offsetTop,a=a.offsetParent;return b},Client:function(a){this.handlers={},this.id=ZeroClipboard_TableTools.nextId++,this.movieId="ZeroClipboard_TableToolsMovie_"+this.id,ZeroClipboard_TableTools.register(this.id,this),a&&this.glue(a)}};ZeroClipboard_TableTools.Client.prototype={id:0,ready:!1,movie:null,clipText:"",fileName:"",action:"copy",handCursorEnabled:!0,cssEffects:!0,handlers:null,sized:!1,glue:function(a,b){this.domElement=ZeroClipboard_TableTools.$(a);var c=99;this.domElement.style.zIndex&&(c=parseInt(this.domElement.style.zIndex)+1);var d=ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement);this.div=document.createElement("div");var e=this.div.style;e.position="absolute",e.left="0px",e.top="0px",e.width=d.width+"px",e.height=d.height+"px",e.zIndex=c,"undefined"!=typeof b&&""!=b&&(this.div.title=b),0!=d.width&&0!=d.height&&(this.sized=!0),this.domElement&&(this.domElement.appendChild(this.div),this.div.innerHTML=this.getHTML(d.width,d.height))},positionElement:function(){var a=ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement),b=this.div.style;b.position="absolute",b.width=a.width+"px",b.height=a.height+"px",0!=a.width&&0!=a.height&&(this.sized=!0,b=this.div.childNodes[0],b.width=a.width,b.height=a.height)},getHTML:function(a,b){var c="",d="id="+this.id+"&width="+a+"&height="+b;if(navigator.userAgent.match(/MSIE/))var e=location.href.match(/^https/i)?"https://":"http://",c=c+('<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+e+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" width="'+a+'" height="'+b+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+ZeroClipboard_TableTools.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+d+'"/><param name="wmode" value="transparent"/></object>');else c+='<embed id="'+this.movieId+'" src="'+ZeroClipboard_TableTools.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+a+'" height="'+b+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+d+'" wmode="transparent" />';return c},hide:function(){this.div&&(this.div.style.left="-2000px")},show:function(){this.reposition()},destroy:function(){if(this.domElement&&this.div){this.hide(),this.div.innerHTML="";var a=document.getElementsByTagName("body")[0];try{a.removeChild(this.div)}catch(b){}this.div=this.domElement=null}},reposition:function(a){a&&((this.domElement=ZeroClipboard_TableTools.$(a))||this.hide());if(this.domElement&&this.div){var a=ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement),b=this.div.style;b.left=""+a.left+"px",b.top=""+a.top+"px"}},clearText:function(){this.clipText="",this.ready&&this.movie.clearText()},appendText:function(a){this.clipText+=a,this.ready&&this.movie.appendText(a)},setText:function(a){this.clipText=a,this.ready&&this.movie.setText(a)},setCharSet:function(a){this.charSet=a,this.ready&&this.movie.setCharSet(a)},setBomInc:function(a){this.incBom=a,this.ready&&this.movie.setBomInc(a)},setFileName:function(a){this.fileName=a,this.ready&&this.movie.setFileName(a)},setAction:function(a){this.action=a,this.ready&&this.movie.setAction(a)},addEventListener:function(a,b){a=a.toString().toLowerCase().replace(/^on/,""),this.handlers[a]||(this.handlers[a]=[]),this.handlers[a].push(b)},setHandCursor:function(a){this.handCursorEnabled=a,this.ready&&this.movie.setHandCursor(a)},setCSSEffects:function(a){this.cssEffects=!!a},receiveEvent:function(a,b){a=a.toString().toLowerCase().replace(/^on/,"");switch(a){case"load":this.movie=document.getElementById(this.movieId);if(!this.movie){var c=this;setTimeout(function(){c.receiveEvent("load",null)},1);return}if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/)){c=this,setTimeout(function(){c.receiveEvent("load",null)},100),this.ready=!0;return}this.ready=!0,this.movie.clearText(),this.movie.appendText(this.clipText),this.movie.setFileName(this.fileName),this.movie.setAction(this.action),this.movie.setCharSet(this.charSet),this.movie.setBomInc(this.incBom),this.movie.setHandCursor(this.handCursorEnabled);break;case"mouseover":this.domElement&&this.cssEffects&&this.recoverActive&&this.domElement.addClass("active");break;case"mouseout":this.domElement&&this.cssEffects&&(this.recoverActive=!1,this.domElement.hasClass("active")&&(this.domElement.removeClass("active"),this.recoverActive=!0));break;case"mousedown":this.domElement&&this.cssEffects&&this.domElement.addClass("active");break;case"mouseup":this.domElement&&this.cssEffects&&(this.domElement.removeClass("active"),this.recoverActive=!1)}if(this.handlers[a])for(var d=0,e=this.handlers[a].length;d<e;d++){var f=this.handlers[a][d];"function"==typeof f?f(this,b):"object"==typeof f&&2==f.length?f[0][f[1]](this,b):"string"==typeof f&&window[f](this,b)}}};var TableTools;(function(a,b,c){TableTools=function(b,c){return!this instanceof TableTools&&alert("Warning: TableTools must be initialised with the keyword 'new'"),this.s={that:this,dt:b.fnSettings(),print:{saveStart:-1,saveLength:-1,saveScroll:-1,funcEnd:function(){}},buttonCounter:0,select:{type:"",selected:[],preRowSelect:null,postSelected:null,postDeselected:null,all:!1,selectedClass:""},custom:{},swfPath:"",buttonSet:[],master:!1,tags:{}},this.dom={container:null,table:null,print:{hidden:[],message:null},collection:{collection:null,background:null}},this.classes=a.extend(!0,{},TableTools.classes),this.s.dt.bJUI&&a.extend(!0,this.classes,TableTools.classes_themeroller),this.fnSettings=function(){return this.s},"undefined"==typeof c&&(c={}),this._fnConstruct(c),this},TableTools.prototype={fnGetSelected:function(){var a=[],b=this.s.dt.aoData,c,d;c=0;for(d=b.length;c<d;c++)b[c]._DTTT_selected&&a.push(b[c].nTr);return a},fnGetSelectedData:function(){var a=[],b=this.s.dt.aoData,c,d;c=0;for(d=b.length;c<d;c++)b[c]._DTTT_selected&&a.push(this.s.dt.oInstance.fnGetData(c));return a},fnIsSelected:function(a){return a=this.s.dt.oInstance.fnGetPosition(a),!0===this.s.dt.aoData[a]._DTTT_selected?!0:!1},fnSelectAll:function(a){var b=this._fnGetMasterSettings();this._fnRowSelect(!0===a?b.dt.aiDisplay:b.dt.aoData)},fnSelectNone:function(a){var b=this._fnGetMasterSettings();this._fnRowDeselect(!0===a?b.dt.aiDisplay:b.dt.aoData)},fnSelect:function(a){"single"==this.s.select.type?(this.fnSelectNone(),this._fnRowSelect(a)):"multi"==this.s.select.type&&this._fnRowSelect(a)},fnDeselect:function(a){this._fnRowDeselect(a)},fnGetTitle:function(a){var b="";return"undefined"!=typeof a.sTitle&&""!==a.sTitle?b=a.sTitle:(a=c.getElementsByTagName("title"),0<a.length&&(b=a[0].innerHTML)),4>"ยก".toString().length?b.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,""):b.replace(/[^a-zA-Z0-9_\.,\-_ !\(\)]/g,"")},fnCalcColRatios:function(a){var b=this.s.dt.aoColumns,a=this._fnColumnTargets(a.mColumns),c=[],d=0,e=0,f,g;f=0;for(g=a.length;f<g;f++)a[f]&&(d=b[f].nTh.offsetWidth,e+=d,c.push(d));f=0;for(g=c.length;f<g;f++)c[f]/=e;return c.join("\t")},fnGetTableData:function(a){if(this.s.dt)return this._fnGetDataTablesData(a)},fnSetText:function(a,b){this._fnFlashSetText(a,b)},fnResizeButtons:function(){for(var a in ZeroClipboard_TableTools.clients)if(a){var b=ZeroClipboard_TableTools.clients[a];"undefined"!=typeof b.domElement&&b.domElement.parentNode&&b.positionElement()}},fnResizeRequired:function(){for(var a in ZeroClipboard_TableTools.clients)if(a){var b=ZeroClipboard_TableTools.clients[a];if("undefined"!=typeof b.domElement&&b.domElement.parentNode==this.dom.container&&!1===b.sized)return!0}return!1},fnPrint:function(a,b){void 0===b&&(b={}),void 0===a||a?this._fnPrintStart(b):this._fnPrintEnd()},fnInfo:function(b,d){var g=c.createElement("div");g.className=this.classes.print.info,g.innerHTML=b,c.body.appendChild(g),setTimeout(function(){a(g).fadeOut("normal",function(){c.body.removeChild(g)})},d)},_fnConstruct:function(a){var b=this;this._fnCustomiseSettings(a),this.dom.container=c.createElement(this.s.tags.container),this.dom.container.className=this.classes.container,"none"!=this.s.select.type&&this._fnRowSelectConfig(),this._fnButtonDefinations(this.s.buttonSet,this.dom.container),this.s.dt.aoDestroyCallback.push({sName:"TableTools",fn:function(){b.dom.container.innerHTML=""}})},_fnCustomiseSettings:function(b){"undefined"==typeof this.s.dt._TableToolsInit&&(this.s.master=!0,this.s.dt._TableToolsInit=!0),this.dom.table=this.s.dt.nTable,this.s.custom=a.extend({},TableTools.DEFAULTS,b),this.s.swfPath=this.s.custom.sSwfPath,"undefined"!=typeof ZeroClipboard_TableTools&&(ZeroClipboard_TableTools.moviePath=this.s.swfPath),this.s.select.type=this.s.custom.sRowSelect,this.s.select.preRowSelect=this.s.custom.fnPreRowSelect,this.s.select.postSelected=this.s.custom.fnRowSelected,this.s.select.postDeselected=this.s.custom.fnRowDeselected,this.s.custom.sSelectedClass&&(this.classes.select.row=this.s.custom.sSelectedClass),this.s.tags=this.s.custom.oTags,this.s.buttonSet=this.s.custom.aButtons},_fnButtonDefinations:function(b,c){for(var d,f=0,g=b.length;f<g;f++){if("string"==typeof b[f]){if("undefined"==typeof TableTools.BUTTONS[b[f]]){alert("TableTools: Warning - unknown button type: "+b[f]);continue}d=a.extend({},TableTools.BUTTONS[b[f]],!0)}else{if("undefined"==typeof TableTools.BUTTONS[b[f].sExtends]){alert("TableTools: Warning - unknown button type: "+b[f].sExtends);continue}d=a.extend({},TableTools.BUTTONS[b[f].sExtends],!0),d=a.extend(d,b[f],!0)}c.appendChild(this._fnCreateButton(d,a(c).hasClass(this.classes.collection.container)))}},_fnCreateButton:function(a,b){var c=this._fnButtonBase(a,b);return a.sAction.match(/flash/)?this._fnFlashConfig(c,a):"text"==a.sAction?this._fnTextConfig(c,a):"div"==a.sAction?this._fnTextConfig(c,a):"collection"==a.sAction&&(this._fnTextConfig(c,a),this._fnCollectionConfig(c,a)),c},_fnButtonBase:function(a,b){var d,e,g;b?(d="default"!==a.sTag?a.sTag:this.s.tags.collection.button,e="default"!==a.sLinerTag?a.sLiner:this.s.tags.collection.liner,g=this.classes.collection.buttons.normal):(d="default"!==a.sTag?a.sTag:this.s.tags.button,e="default"!==a.sLinerTag?a.sLiner:this.s.tags.liner,g=this.classes.buttons.normal),d=c.createElement(d),e=c.createElement(e);var h=this._fnGetMasterSettings();return d.className=g+" "+a.sButtonClass,d.setAttribute("id","ToolTables_"+this.s.dt.sInstance+"_"+h.buttonCounter),d.appendChild(e),e.innerHTML=a.sButtonText,h.buttonCounter++,d},_fnGetMasterSettings:function(){if(this.s.master)return this.s;for(var a=TableTools._aInstances,b=0,c=a.length;b<c;b++)if(this.dom.table==a[b].s.dt.nTable)return a[b].s},_fnCollectionConfig:function(a,b){var d=c.createElement(this.s.tags.collection.container);d.style.display="none",d.className=this.classes.collection.container,b._collection=d,c.body.appendChild(d),this._fnButtonDefinations(b.aButtons,d)},_fnCollectionShow:function(d,g){var h=this,i=a(d).offset(),j=g._collection,k=i.left,i=i.top+a(d).outerHeight(),l=a(b).height(),n=a(c).height(),o=a(b).width(),p=a(c).width();j.style.position="absolute",j.style.left=k+"px",j.style.top=i+"px",j.style.display="block",a(j).css("opacity",0);var q=c.createElement("div");q.style.position="absolute",q.style.left="0px",q.style.top="0px",q.style.height=(l>n?l:n)+"px",q.style.width=(o>p?o:p)+"px",q.className=this.classes.collection.background,a(q).css("opacity",0),c.body.appendChild(q),c.body.appendChild(j),l=a(j).outerWidth(),o=a(j).outerHeight(),k+l>p&&(j.style.left=p-l+"px"),i+o>n&&(j.style.top=i-o-a(d).outerHeight()+"px"),this.dom.collection.collection=j,this.dom.collection.background=q,setTimeout(function(){a(j).animate({opacity:1},500),a(q).animate({opacity:.25},500)},10),this.fnResizeButtons(),a(q).click(function(){h._fnCollectionHide.call(h,null,null)})},_fnCollectionHide:function(b,c){(null===c||"collection"!=c.sExtends)&&null!==this.dom.collection.collection&&(a(this.dom.collection.collection).animate({opacity:0},500,function(){this.style.display="none"}),a(this.dom.collection.background).animate({opacity:0},500,function(){this.parentNode.removeChild(this)}),this.dom.collection.collection=null,this.dom.collection.background=null)},_fnRowSelectConfig:function(){if(this.s.master){var b=this,c=this.s.dt;a(c.nTable).addClass(this.classes.select.table),a("tr",c.nTBody).live("click",function(a){this.parentNode==c.nTBody&&null!==c.oInstance.fnGetData(this)&&(null===b.s.select.preRowSelect||b.s.select.preRowSelect.call(b,a))&&(b.fnIsSelected(this)?b._fnRowDeselect(this):"single"==b.s.select.type?(b.fnSelectNone(),b._fnRowSelect(this)):"multi"==b.s.select.type&&b._fnRowSelect(this))}),c.oApi._fnCallbackReg(c,"aoRowCreatedCallback",function(d,f,g){c.aoData[g]._DTTT_selected&&a(d).addClass(b.classes.select.row)},"TableTools-SelectAll")}},_fnRowSelect:function(b){for(var b=this._fnSelectData(b),c=0===b.length?null:b[0].nTr,d=0,f=b.length;d<f;d++)b[d]._DTTT_selected=!0,b[d].nTr&&a(b[d].nTr).addClass(this.classes.select.row);null!==this.s.select.postSelected&&this.s.select.postSelected.call(this,c),TableTools._fnEventDispatch(this,"select",c)},_fnRowDeselect:function(b){for(var b=this._fnSelectData(b),c=0===b.length?null:b[0].nTr,d=0,f=b.length;d<f;d++)b[d].nTr&&b[d]._DTTT_selected&&a(b[d].nTr).removeClass(this.classes.select.row),b[d]._DTTT_selected=!1;null!==this.s.select.postDeselected&&this.s.select.postDeselected.call(this,c),TableTools._fnEventDispatch(this,"select",c)},_fnSelectData:function(a){var b=[],c,d,e;if(a.nodeName)c=this.s.dt.oInstance.fnGetPosition(a),b.push(this.s.dt.aoData[c]);else if("undefined"!=typeof a.length){d=0;for(e=a.length;d<e;d++)a[d].nodeName?(c=this.s.dt.oInstance.fnGetPosition(a[d]),b.push(this.s.dt.aoData[c])):"number"==typeof a[d]?b.push(this.s.dt.aoData[a[d]]):b.push(a[d])}else b.push(a);return b},_fnTextConfig:function(b,c){var d=this;null!==c.fnInit&&c.fnInit.call(this,b,c),""!==c.sToolTip&&(b.title=c.sToolTip),a(b).hover(function(){c.fnMouseover!==null&&c.fnMouseover.call(this,b,c,null)},function(){c.fnMouseout!==null&&c.fnMouseout.call(this,b,c,null)}),null!==c.fnSelect&&TableTools._fnEventListen(this,"select",function(a){c.fnSelect.call(d,b,c,a)}),a(b).click(function(){c.fnClick!==null&&c.fnClick.call(d,b,c,null),c.fnComplete!==null&&c.fnComplete.call(d,b,c,null,null),d._fnCollectionHide(b,c)})},_fnFlashConfig:function(a,b){var c=this,d=new ZeroClipboard_TableTools.Client;null!==b.fnInit&&b.fnInit.call(this,a,b),d.setHandCursor(!0),"flash_save"==b.sAction?(d.setAction("save"),d.setCharSet("utf16le"==b.sCharSet?"UTF16LE":"UTF8"),d.setBomInc(b.bBomInc),d.setFileName(b.sFileName.replace("*",this.fnGetTitle(b)))):"flash_pdf"==b.sAction?(d.setAction("pdf"),d.setFileName(b.sFileName.replace("*",this.fnGetTitle(b)))):d.setAction("copy"),d.addEventListener("mouseOver",function(){b.fnMouseover!==null&&b.fnMouseover.call(c,a,b,d)}),d.addEventListener("mouseOut",function(){b.fnMouseout!==null&&b.fnMouseout.call(c,a,b,d)}),d.addEventListener("mouseDown",function(){b.fnClick!==null&&b.fnClick.call(c,a,b,d)}),d.addEventListener("complete",function(e,f){b.fnComplete!==null&&b.fnComplete.call(c,a,b,d,f),c._fnCollectionHide(a,b)}),this._fnFlashGlue(d,a,b.sToolTip)},_fnFlashGlue:function(a,b,d){var e=this,g=b.getAttribute("id");c.getElementById(g)?a.glue(b,d):setTimeout(function(){e._fnFlashGlue(a,b,d)},100)},_fnFlashSetText:function(a,b){var c=this._fnChunkData(b,8192);a.clearText();for(var d=0,e=c.length;d<e;d++)a.appendText(c[d])},_fnColumnTargets:function(a){var b=[],c=this.s.dt;if("object"==typeof a){i=0;for(iLen=c.aoColumns.length;i<iLen;i++)b.push(!1);i=0;for(iLen=a.length;i<iLen;i++)b[a[i]]=!0}else if("visible"==a){i=0;for(iLen=c.aoColumns.length;i<iLen;i++)b.push(c.aoColumns[i].bVisible?!0:!1)}else if("hidden"==a){i=0;for(iLen=c.aoColumns.length;i<iLen;i++)b.push(c.aoColumns[i].bVisible?!1:!0)}else if("sortable"==a){i=0;for(iLen=c.aoColumns.length;i<iLen;i++)b.push(c.aoColumns[i].bSortable?!0:!1)}else{i=0;for(iLen=c.aoColumns.length;i<iLen;i++)b.push(!0)}return b},_fnNewline:function(a){return"auto"==a.sNewLine?navigator.userAgent.match(/Windows/)?"\r\n":"\n":a.sNewLine},_fnGetDataTablesData:function(b){var c,d,f,g,h,i=[],j="",k=this.s.dt,l,m=RegExp(b.sFieldBoundary,"g"),n=this._fnColumnTargets(b.mColumns);f="undefined"!=typeof b.bSelectedOnly?b.bSelectedOnly:!1;if(b.bHeader){h=[],c=0;for(d=k.aoColumns.length;c<d;c++)n[c]&&(j=k.aoColumns[c].sTitle.replace(/\n/g," ").replace(/<.*?>/g,"").replace(/^\s+|\s+$/g,""),j=this._fnHtmlDecode(j),h.push(this._fnBoundData(j,b.sFieldBoundary,m)));i.push(h.join(b.sFieldSeperator))}var o=k.aiDisplay;g=this.fnGetSelected();if("none"!==this.s.select.type&&f&&0!==g.length){o=[],c=0;for(d=g.length;c<d;c++)o.push(k.oInstance.fnGetPosition(g[c]))}f=0;for(g=o.length;f<g;f++){l=k.aoData[o[f]].nTr,h=[],c=0;for(d=k.aoColumns.length;c<d;c++)n[c]&&(j=k.oApi._fnGetCellData(k,o[f],c,"display"),b.fnCellRender?j=b.fnCellRender(j,c,l,o[f])+"":"string"==typeof j?(j=j.replace(/\n/g," "),j=j.replace(/<img.*?\s+alt\s*=\s*(?:"([^"]+)"|'([^']+)'|([^\s>]+)).*?>/gi,"$1$2$3"),j=j.replace(/<.*?>/g,"")):j+="",j=j.replace(/^\s+/,"").replace(/\s+$/,""),j=this._fnHtmlDecode(j),h.push(this._fnBoundData(j,b.sFieldBoundary,m)));i.push(h.join(b.sFieldSeperator)),b.bOpenRows&&(c=a.grep(k.aoOpenRows,function(a){return a.nParent===l}),1===c.length&&(j=this._fnBoundData(a("td",c[0].nTr).html(),b.sFieldBoundary,m),i.push(j)))}if(b.bFooter&&null!==k.nTFoot){h=[],c=0;for(d=k.aoColumns.length;c<d;c++)n[c]&&null!==k.aoColumns[c].nTf&&(j=k.aoColumns[c].nTf.innerHTML.replace(/\n/g," ").replace(/<.*?>/g,""),j=this._fnHtmlDecode(j),h.push(this._fnBoundData(j,b.sFieldBoundary,m)));i.push(h.join(b.sFieldSeperator))}return _sLastData=i.join(this._fnNewline(b))},_fnBoundData:function(a,b,c){return""===b?a:b+a.replace(c,b+b)+b},_fnChunkData:function(a,b){for(var c=[],d=a.length,e=0;e<d;e+=b)e+b<d?c.push(a.substring(e,e+b)):c.push(a.substring(e,d));return c},_fnHtmlDecode:function(a){if(-1==a.indexOf("&"))return a;var a=this._fnChunkData(a,2048),b=c.createElement("div"),d,e,g,h="";d=0;for(e=a.length;d<e;d++)g=a[d].lastIndexOf("&"),-1!=g&&8<=a[d].length&&g>a[d].length-8&&(a[d].substr(g),a[d]=a[d].substr(0,g)),b.innerHTML=a[d],h+=b.childNodes[0].nodeValue;return h},_fnPrintStart:function(d){var g=this,h=this.s.dt;this._fnPrintHideNodes(h.nTable),this.s.print.saveStart=h._iDisplayStart,this.s.print.saveLength=h._iDisplayLength,d.bShowAll&&(h._iDisplayStart=0,h._iDisplayLength=-1,h.oApi._fnCalculateEnd(h),h.oApi._fnDraw(h)),(""!==h.oScroll.sX||""!==h.oScroll.sY)&&this._fnPrintScrollStart(h);var h=h.aanFeatures,i;for(i in h)if("i"!=i&&"t"!=i&&1==i.length)for(var j=0,k=h[i].length;j<k;j++)this.dom.print.hidden.push({node:h[i][j],display:"block"}),h[i][j].style.display="none";a(c.body).addClass(this.classes.print.body),""!==d.sInfo&&this.fnInfo(d.sInfo,3e3),d.sMessage&&(this.dom.print.message=c.createElement("div"),this.dom.print.message.className=this.classes.print.message,this.dom.print.message.innerHTML=d.sMessage,c.body.insertBefore(this.dom.print.message,c.body.childNodes[0])),this.s.print.saveScroll=a(b).scrollTop(),b.scrollTo(0,0),a(c).bind("keydown.DTTT",function(a){a.keyCode==27&&(a.preventDefault(),g._fnPrintEnd.call(g,a))})},_fnPrintEnd:function(){var d=this.s.dt,g=this.s.print,h=this.dom.print;this._fnPrintShowNodes(),(""!==d.oScroll.sX||""!==d.oScroll.sY)&&this._fnPrintScrollEnd(),b.scrollTo(0,g.saveScroll),null!==h.message&&(c.body.removeChild(h.message),h.message=null),a(c.body).removeClass("DTTT_Print"),d._iDisplayStart=g.saveStart,d._iDisplayLength=g.saveLength,d.oApi._fnCalculateEnd(d),d.oApi._fnDraw(d),a(c).unbind("keydown.DTTT")},_fnPrintScrollStart:function(){var b=this.s.dt;b.nScrollHead.getElementsByTagName("div")[0].getElementsByTagName("table");var c=b.nTable.parentNode,d=b.nTable.getElementsByTagName("thead");0<d.length&&b.nTable.removeChild(d[0]),null!==b.nTFoot&&(d=b.nTable.getElementsByTagName("tfoot"),0<d.length&&b.nTable.removeChild(d[0])),d=b.nTHead.cloneNode(!0),b.nTable.insertBefore(d,b.nTable.childNodes[0]),null!==b.nTFoot&&(d=b.nTFoot.cloneNode(!0),b.nTable.insertBefore(d,b.nTable.childNodes[1])),""!==b.oScroll.sX&&(b.nTable.style.width=a(b.nTable).outerWidth()+"px",c.style.width=a(b.nTable).outerWidth()+"px",c.style.overflow="visible"),""!==b.oScroll.sY&&(c.style.height=a(b.nTable).outerHeight()+"px",c.style.overflow="visible")},_fnPrintScrollEnd:function(){var a=this.s.dt,b=a.nTable.parentNode;""!==a.oScroll.sX&&(b.style.width=a.oApi._fnStringToCss(a.oScroll.sX),b.style.overflow="auto"),""!==a.oScroll.sY&&(b.style.height=a.oApi._fnStringToCss(a.oScroll.sY),b.style.overflow="auto")},_fnPrintShowNodes:function(){for(var a=this.dom.print.hidden,b=0,c=a.length;b<c;b++)a[b].node.style.display=a[b].display;a.splice(0,a.length)},_fnPrintHideNodes:function(b){for(var c=this.dom.print.hidden,d=b.parentNode,f=d.childNodes,g=0,h=f.length;g<h;g++)if(f[g]!=b&&1==f[g].nodeType){var i=a(f[g]).css("display");"none"!=i&&(c.push({node:f[g],display:i}),f[g].style.display="none")}"BODY"!=d.nodeName&&this._fnPrintHideNodes(d)}},TableTools._aInstances=[],TableTools._aListeners=[],TableTools.fnGetMasters=function(){for(var a=[],b=0,c=TableTools._aInstances.length;b<c;b++)TableTools._aInstances[b].s.master&&a.push(TableTools._aInstances[b]);return a},TableTools.fnGetInstance=function(a){"object"!=typeof a&&(a=c.getElementById(a));for(var b=0,d=TableTools._aInstances.length;b<d;b++)if(TableTools._aInstances[b].s.master&&TableTools._aInstances[b].dom.table==a)return TableTools._aInstances[b];return null},TableTools._fnEventListen=function(a,b,c){TableTools._aListeners.push({that:a,type:b,fn:c})},TableTools._fnEventDispatch=function(a,b,c){for(var d=TableTools._aListeners,e=0,f=d.length;e<f;e++)a.dom.table==d[e].that.dom.table&&d[e].type==b&&d[e].fn(c)},TableTools.buttonBase={sAction:"text",sTag:"default",sLinerTag:"default",sButtonClass:"DTTT_button_text",sButtonText:"Button text",sTitle:"",sToolTip:"",sCharSet:"utf8",bBomInc:!1,sFileName:"*.csv",sFieldBoundary:"",sFieldSeperator:"\t",sNewLine:"auto",mColumns:"all",bHeader:!0,bFooter:!0,bOpenRows:!1,bSelectedOnly:!1,fnMouseover:null,fnMouseout:null,fnClick:null,fnSelect:null,fnComplete:null,fnInit:null,fnCellRender:null},TableTools.BUTTONS={csv:a.extend({},TableTools.buttonBase,{sAction:"flash_save",sButtonClass:"DTTT_button_csv",sButtonText:"CSV",sFieldBoundary:'"',sFieldSeperator:",",fnClick:function(a,b,c){this.fnSetText(c,this.fnGetTableData(b))}}),xls:a.extend({},TableTools.buttonBase,{sAction:"flash_save",sCharSet:"utf16le",bBomInc:!0,sButtonClass:"DTTT_button_xls",sButtonText:"Excel",fnClick:function(a,b,c){this.fnSetText(c,this.fnGetTableData(b))}}),copy:a.extend({},TableTools.buttonBase,{sAction:"flash_copy",sButtonClass:"DTTT_button_copy",sButtonText:"Copy",fnClick:function(a,b,c){this.fnSetText(c,this.fnGetTableData(b))},fnComplete:function(a,b,c,d){a=d.split("\n").length,a=null===this.s.dt.nTFoot?a-1:a-2,this.fnInfo("<h6>Table copied</h6><p>Copied "+a+" row"+(1==a?"":"s")+" to the clipboard.</p>",1500)}}),pdf:a.extend({},TableTools.buttonBase,{sAction:"flash_pdf",sNewLine:"\n",sFileName:"*.pdf",sButtonClass:"DTTT_button_pdf",sButtonText:"PDF",sPdfOrientation:"portrait",sPdfSize:"A4",sPdfMessage:"",fnClick:function(a,b,c){this.fnSetText(c,"title:"+this.fnGetTitle(b)+"\nmessage:"+b.sPdfMessage+"\ncolWidth:"+this.fnCalcColRatios(b)+"\norientation:"+b.sPdfOrientation+"\nsize:"+b.sPdfSize+"\n--/TableToolsOpts--\n"+this.fnGetTableData(b))}}),print:a.extend({},TableTools.buttonBase,{sInfo:"<h6>Print view</h6><p>Please use your browser's print function to print this table. Press escape when finished.",sMessage:null,bShowAll:!0,sToolTip:"View print view",sButtonClass:"DTTT_button_print",sButtonText:"Print",fnClick:function(a,b){this.fnPrint(!0,b)}}),text:a.extend({},TableTools.buttonBase),select:a.extend({},TableTools.buttonBase,{sButtonText:"Select button",fnSelect:function(b){0!==this.fnGetSelected().length?a(b).removeClass(this.classes.buttons.disabled):a(b).addClass(this.classes.buttons.disabled)},fnInit:function(b){a(b).addClass(this.classes.buttons.disabled)}}),select_single:a.extend({},TableTools.buttonBase,{sButtonText:"Select button",fnSelect:function(b){1==this.fnGetSelected().length?a(b).removeClass(this.classes.buttons.disabled):a(b).addClass(this.classes.buttons.disabled)},fnInit:function(b){a(b).addClass(this.classes.buttons.disabled)}}),select_all:a.extend({},TableTools.buttonBase,{sButtonText:"Select all",fnClick:function(){this.fnSelectAll()},fnSelect:function(b){this.fnGetSelected().length==this.s.dt.fnRecordsDisplay()?a(b).addClass(this.classes.buttons.disabled):a(b).removeClass(this.classes.buttons.disabled)}}),select_none:a.extend({},TableTools.buttonBase,{sButtonText:"Deselect all",fnClick:function(){this.fnSelectNone()},fnSelect:function(b){0!==this.fnGetSelected().length?a(b).removeClass(this.classes.buttons.disabled):a(b).addClass(this.classes.buttons.disabled)},fnInit:function(b){a(b).addClass(this.classes.buttons.disabled)}}),ajax:a.extend({},TableTools.buttonBase,{sAjaxUrl:"/xhr.php",sButtonText:"Ajax button",fnClick:function(b,c){var d=this.fnGetTableData(c);a.ajax({url:c.sAjaxUrl,data:[{name:"tableData",value:d}],success:c.fnAjaxComplete,dataType:"json",type:"POST",cache:!1,error:function(){alert("Error detected when sending table data to server")}})},fnAjaxComplete:function(){alert("Ajax complete")}}),div:a.extend({},TableTools.buttonBase,{sAction:"div",sTag:"div",sButtonClass:"DTTT_nonbutton",sButtonText:"Text button"}),collection:a.extend({},TableTools.buttonBase,{sAction:"collection",sButtonClass:"DTTT_button_collection",sButtonText:"Collection",fnClick:function(a,b){this._fnCollectionShow(a,b)}})},TableTools.classes={container:"DTTT_container",buttons:{normal:"DTTT_button",disabled:"DTTT_disabled"},collection:{container:"DTTT_collection",background:"DTTT_collection_background",buttons:{normal:"DTTT_button",disabled:"DTTT_disabled"}},select:{table:"DTTT_selectable",row:"DTTT_selected"},print:{body:"DTTT_Print",info:"DTTT_print_info",message:"DTTT_PrintMessage"}},TableTools.classes_themeroller={container:"DTTT_container ui-buttonset ui-buttonset-multi",buttons:{normal:"DTTT_button ui-button ui-state-default"},collection:{container:"DTTT_collection ui-buttonset ui-buttonset-multi"}},TableTools.DEFAULTS={sSwfPath:"media/swf/copy_csv_xls_pdf.swf",sRowSelect:"none",sSelectedClass:null,fnPreRowSelect:null,fnRowSelected:null,fnRowDeselected:null,aButtons:["copy","csv","xls","pdf","print"],oTags:{container:"div",button:"a",liner:"span",collection:{container:"div",button:"a",liner:"span"}}},TableTools.prototype.CLASS="TableTools",TableTools.VERSION="2.1.3",TableTools.prototype.VERSION=TableTools.VERSION,"function"==typeof a.fn.dataTable&&"function"==typeof a.fn.dataTableExt.fnVersionCheck&&a.fn.dataTableExt.fnVersionCheck("1.9.0")?a.fn.dataTableExt.aoFeatures.push({fnInit:function(a){return a=new TableTools(a.oInstance,"undefined"!=typeof a.oInit.oTableTools?a.oInit.oTableTools:{}),TableTools._aInstances.push(a),a.dom.container},cFeature:"T",sFeature:"TableTools"}):alert("Warning: TableTools 2 requires DataTables 1.9.0 or newer - www.datatables.net/download"),a.fn.DataTable.TableTools=TableTools})(jQuery,window,document);